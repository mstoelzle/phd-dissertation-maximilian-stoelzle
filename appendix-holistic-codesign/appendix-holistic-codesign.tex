% \chapter{How Holistic Co-Design Will Enable the Societal Uptake of Soft Robots}
\chapter{Safe yet Effective Soft Robots via Holistic Co-Design}
\label{chp:apx:holisticcodesign}

\begin{foreword}
    % In this thesis, we followed (so far) a traditional sequential design process: the soft robot's morphology, including structural shape, actuation, and sensor placement, was usually given and we assumed it to be fixed. Subsequently, we derived or learned reduced-order kinematic models and control-oriented dynamic models.
    % Finally, we leveraged the model knowledge within controllers and tuned their parameters (e.g., gains).
    % A good example for this sequential process are the \gls{HSA} which we extensively covered in this thesis: their design, including actuation, was done at the Distributed Robotics Lab (DRL) at MIT~\citep{lipton2018handedness, chin2018compliant, truby2021recipe}. Subsequently, as presented in Chapter~\ref{chp:hsamodel}, we derived kinematic and dynamical models from first principles, where we, particularly for the kinematic model, made extensive use of our intuition and prior experience, and subsequently determined their parameters via system identification.  Next, we devised model-based controllers in Chapter~\ref{chp:hsacontrol} and experimentally tuned their gains, and, finally, in Chapter~\ref{chp:braincontrol} developed a \gls{BMI} interface for guiding the low-level controller via brain signals measured with \gls{EEG} devices.
    % However, this sequential design process prevents from learnings and findings at later stages (e.g., during closed-loop control experiments) to influence the morphological design. This is a common issue in the larger soft robot community, where, for example, many designs are developed which are challenging to model via reduced order approaches and control precisely.
    % Instead, we consider in this appendix the co-design of the body (e.g., morphology) and the brain (e.g., control and perception algorithms) of soft robots which includes structured feedback mechanisms for iteratively optimizing the entire design of the soft robot. Specifically, we review the aspects currently lacking in soft robot co-design techniques and give suggestions how to resolve them via a proposed holistic co-design framework.
    In this thesis, we employed (so far) a traditional sequential design process: the soft robot’s morphology—including its structural shape, actuation, and sensor placement—was predefined and assumed fixed. We then derived or learned reduced-order kinematic and control-oriented dynamic models, leveraging this model knowledge within controllers whose parameters (e.g., gains) were subsequently tuned. A notable example of this process is the design of \gls{HSA} robots, extensively covered in this work. First, their design and actuation were developed at the Distributed Robotics Laboratory (DRL) at MIT~\citep{lipton2018handedness, chin2018compliant, truby2021recipe}. Subsequently, we developed in this thesis modeling and control approaches for such \gls{HSA} robots. In Chapter~\ref{chp:hsamodel}, we derived kinematic and dynamic models from first principles—relying heavily on our intuition and prior experience for the kinematic model—and determined their parameters via system identification. We then devised model-based controllers in Chapter~\ref{chp:hsacontrol} and experimentally tuned their gains, culminating in the development of a \gls{BMI} interface in Chapter~\ref{chp:braincontrol} to guide the low-level controller using EEG-measured brain signals.
    %
    However, this sequential process prevents insights gained during later stages, such as closed-loop control experiments, from influencing the morphological design. This is a common challenge within the soft robotics community, where many designs prove difficult to model with reduced-order approaches and control accurately. In this appendix, we instead consider the co-design of the body (morphology) and the brain (control and perception algorithms) of soft robots, incorporating structured feedback mechanisms to iteratively optimize the entire design. Specifically, we review current gaps in soft robot co-design techniques and propose solutions through a holistic co-design framework, which also considers the co-optimization of control-oriented reduced-order models and (model-based) controllers.
\end{foreword}

\pagebreak

\begin{abstract}
    % Soft robots promise inherent safety and embodied intelligence, enabling seamless interactions with both people and delicate environments. Yet their development remains challenging, as it requires integrating materials, geometry, actuation, and control into a cohesive design strategy. Despite recent progress, the field still struggles to balance task-specific performance with broader system-level considerations, often resulting in fragmented design approaches. For instance, lacking a quantitative safety metric, many designs are rendered overly soft—compromising crucial performance aspects such as motion precision and payload capacity. In this chapter, we propose a holistic co-design framework that transcends conventional optimization by viewing soft robots as inherently interconnected systems. Specifically, we call for the creation of a quantitative safety metric for soft robots, introduce techniques to significantly enhance computational efficiency in co-design, and advocate for moving beyond solely simulation-based evaluations by incorporating purposeful real-world prototyping. We believe that this holistic framework has the potential to greatly enhance the performance and overall value of soft robots while maintaining essential safety, ultimately redefining human-robot interaction and fostering greater acceptance and confidence in soft robotic systems.  
    % The development of soft robots remains particularly challenging, as it requires integrating materials, geometry, actuation, and autonomy stacks into a complex mechatronic system. Despite recent progress, the field still struggles to balance task-specific performance with broader system-level considerations, such as durability and manufacturability, often resulting in not sufficiently effective designs, that is at least partially a consequence of a traditional sequential design process.
    % Recently, co-design approaches that co-optimize the body and brain of soft robots have been started to be investigated.
    % However, while designing morphology and control together has lead to the identification of interesting unconventional designs, the existing methods have three major shortcomings: First, most approaches evaluate one task performance metric sin simulation, while a design that is effective and optimal in the real world needs to fulfill many more values.
    % Secondly, existing approaches focus on computational modeling of the design and ignore that the goal at the end is to realize the design into a mechatronic system whose actual performance might be degraded as a result of the sim-to-real gap.
    % Thirdly, existing approaches are computationally inefficient, therefore, not allowing an effective exploration of the full design space.
    % In this chapter, we propose a holistic co-design framework for soft robots that aims to resolve all three challenges by i) considering a broad of design values, ii) explicitly account for the realization of the design and how prototyping in the real world can help decrease the uncertainty in metrics that we use to optimize the design, iii) multiple modifications that have the potential to dramatically increase the computational efficiency, such as auxiliary metrics that are less expensive to evaluate or a model-based derivation of the control policy.
    % We believe that this holistic framework has the potential to greatly enhance the performance and overall value of soft robots, ultimately redefining human-robot interaction and fostering greater acceptance and confidence in soft robotic systems. 
    The development of soft robots remains particularly challenging, as it requires integrating materials, geometry, actuation, and autonomy stacks into a complex mechatronic system. Despite recent progress, the field still struggles to balance task-specific performance with broader system-level considerations—such as durability and manufacturability—often resulting in suboptimal designs, partly due to following a traditional sequential design process. Recently, co-design approaches that simultaneously optimize the body and brain of soft robots have begun to emerge. While combining morphology and control has revealed intriguing, unconventional designs, existing methods face three major shortcomings. First, most approaches rely on simulation-based evaluations that focus on a single performance metric, even though an effective real-world design must satisfy a broader range of values. Second, current methods concentrate on computational modeling without fully addressing the need to realize the design as a mechatronic system whose performance can be compromised by the sim-to-real gap. Third, these approaches are computationally inefficient, limiting the exploration of the full design space.
    In this chapter, we propose a holistic co-design framework for soft robots that tackles these challenges by (i) considering a wider array of design values, (ii) explicitly accounting for the realization of the design and how real-world prototyping can reduce uncertainties in evaluation metrics, and (iii) incorporating modifications that dramatically increase computational efficiency—such as using less expensive auxiliary metrics or adopting model-based control derivation. We believe this holistic framework has the potential to significantly enhance the performance and overall value of soft robots, ultimately redefining human-robot interaction and fostering greater acceptance and confidence in these systems.
\end{abstract}

\blfootnote{
    This chapter is partly based on \faFileTextO~\emph{\textbf{M. Stölzle}*, N. Pagliarani*, F. Stella*, J. Hughes, C. Laschi, D. Rus, M. Cianchetti, C. Della Santina, and G. Zardini (2025). Safe yet Effective Soft Robots via Holistic Co-Design. In Nature Machine Intelligence, \textbf{\emph{In Preparation}}}.

    % \nth{1}-author contributions: M. Stölzle conceived and led the project and wrote the vast majority of the content presented in this chapter. The other co-first-authors contributed ideas and were responsible for the graphics.

    $^*$M.S., N.P., and F.S. equally contributed to this work.
    M.S. conceived and led the project.
    All authors contributed ideas to this perspective.
    N.P., F.S., and M.S. collaborated on the figures and graphics.
    M.S. wrote the majority and N.P. and F.S. parts of the manuscript.
    All authors revised the manuscript.
    G.Z., C.D.S, M.C., and J.H. supervised the project and provided funding.
}

%% Start the actual chapter on a new page.
\newpage

\input{appendix-holistic-codesign/sections/S01_introduction}
\input{appendix-holistic-codesign/sections/S02_related_work}
\input{appendix-holistic-codesign/sections/S03_holistic_codesign_framework}
\input{appendix-holistic-codesign/sections/S04_reduced_order_design_parametrizations}
\input{appendix-holistic-codesign/sections/S05_probabilistic_codesign_metrics}
\input{appendix-holistic-codesign/sections/S06_codesigning_physical_intelligence}
\input{appendix-holistic-codesign/sections/S07_safety_vs_performance_tradeoff}
\input{appendix-holistic-codesign/sections/S08_conclusion}