% \chapter{How Holistic Co-Design Will Enable the Societal Uptake of Soft Robots}
\chapter{Safe yet Effective Soft Robots via Holistic Co-Design}
\label{chp:apx:holisticcodesign}

\begin{foreword}
    % In this thesis, we followed (so far) a traditional sequential design process: the soft robot's morphology, including structural shape, actuation, and sensor placement, was usually given and we assumed it to be fixed. Subsequently, we derived or learned reduced-order kinematic models and control-oriented dynamic models.
    % Finally, we leveraged the model knowledge within controllers and tuned their parameters (e.g., gains).
    % A good example for this sequential process are the \gls{HSA} which we extensively covered in this thesis: their design, including actuation, was done at the Distributed Robotics Lab (DRL) at MIT~\citep{lipton2018handedness, chin2018compliant, truby2021recipe}. Subsequently, as presented in Chapter~\ref{chp:hsamodel}, we derived kinematic and dynamical models from first principles, where we, particularly for the kinematic model, made extensive use of our intuition and prior experience, and subsequently determined their parameters via system identification.  Next, we devised model-based controllers in Chapter~\ref{chp:hsacontrol} and experimentally tuned their gains, and, finally, in Chapter~\ref{chp:braincontrol} developed a \gls{BMI} interface for guiding the low-level controller via brain signals measured with \gls{EEG} devices.
    % However, this sequential design process prevents from learnings and findings at later stages (e.g., during closed-loop control experiments) to influence the morphological design. This is a common issue in the larger soft robot community, where, for example, many designs are developed which are challenging to model via reduced order approaches and control precisely.
    % Instead, we consider in this appendix the co-design of the body (e.g., morphology) and the brain (e.g., control and perception algorithms) of soft robots which includes structured feedback mechanisms for iteratively optimizing the entire design of the soft robot. Specifically, we review the aspects currently lacking in soft robot co-design techniques and give suggestions how to resolve them via a proposed holistic co-design framework.
    In this thesis, we employed (so far) a traditional sequential design process: the soft robot’s morphology—including its structural shape, actuation, and sensor placement—was predefined and assumed fixed. We then derived or learned reduced-order kinematic and control-oriented dynamic models, leveraging this model knowledge within controllers whose parameters (e.g., gains) were subsequently tuned. A notable example of this process is the design of \gls{HSA} robots, extensively covered in this work. First, their design and actuation were developed at the Distributed Robotics Laboratory (DRL) at MIT~\citep{lipton2018handedness, chin2018compliant, truby2021recipe}. Subsequently, we developed in this thesis modeling and control approaches for such \gls{HSA} robots. In Chapter~\ref{chp:hsamodel}, we derived kinematic and dynamic models from first principles—relying heavily on our intuition and prior experience for the kinematic model—and determined their parameters via system identification. We then devised model-based controllers in Chapter~\ref{chp:hsacontrol} and experimentally tuned their gains, culminating in the development of a \gls{BMI} interface in Chapter~\ref{chp:braincontrol} to guide the low-level controller using EEG-measured brain signals.
    %
    However, this sequential process prevents insights gained during later stages, such as closed-loop control experiments, from influencing the morphological design. This is a common challenge within the soft robotics community, where many designs prove difficult to model with reduced-order approaches and control accurately. In this appendix, we instead consider the co-design of the body (morphology) and the brain (control and perception algorithms) of soft robots, incorporating structured feedback mechanisms to iteratively optimize the entire design. Specifically, we review current gaps in soft robot co-design techniques and propose solutions through a holistic co-design framework, which also considers the co-optimization of control-oriented reduced-order models and (model-based) controllers.
\end{foreword}

\pagebreak

\begin{abstract}
    % The development of soft robots remains particularly challenging, as it requires integrating materials, geometry, actuation, and autonomy stacks into a complex mechatronic system. Despite recent progress, the field still struggles to balance task-specific performance with broader system-level considerations—such as durability and manufacturability—often resulting in suboptimal designs, partly due to following a traditional sequential design process. Recently, co-design approaches that simultaneously optimize the body and brain of soft robots have begun to emerge. While combining morphology and control has revealed intriguing, unconventional designs, existing methods face three major shortcomings. First, most approaches rely on simulation-based evaluations that focus on a single performance metric, even though an effective real-world design must satisfy a broader range of values. Second, current methods concentrate on computational modeling without fully addressing the need to realize the design as a mechatronic system whose performance can be compromised by the sim-to-real gap. Third, these approaches are computationally inefficient, limiting the exploration of the full design space.
    % In this chapter, we propose a holistic co-design framework for soft robots that tackles these challenges by (i) considering a wider array of design values, (ii) explicitly accounting for the realization of the design and how real-world prototyping can reduce uncertainties in evaluation metrics, and (iii) incorporating modifications that dramatically increase computational efficiency—such as using less expensive auxiliary metrics or adopting model-based control derivation. We believe this holistic framework has the potential to significantly enhance the performance and overall value of soft robots, ultimately redefining human-robot interaction and fostering greater acceptance and confidence in these systems.
    Soft robots promise inherent safety via their material compliance for seamless interactions with humans or delicate environments. Yet, their development is challenging because it requires integrating materials, geometry, actuation, and autonomy into complex mechatronic systems. Despite progress, the field struggles to balance task-specific performance with broader factors like durability and manufacturability—a difficulty that we find is compounded by traditional sequential design processes with their lack of feedback loops. 
    In this perspective, we review emerging co-design approaches that simultaneously optimize the body and brain, enabling the discovery of unconventional designs highly tailored to the given tasks. We then identify three key shortcomings that limit the broader adoption of such co-design methods within the soft robotics domain.
    First, many rely on simulation-based evaluations focusing on a single metric, while real-world designs must satisfy diverse criteria. Second, current methods emphasize computational modeling without ensuring feasible realization, risking sim-to-real performance gaps. Third, high computational demands limit the exploration of the complete design space. Finally, we propose a holistic co-design framework that addresses these challenges by incorporating a broader range of design values, integrating real-world prototyping to refine evaluations, and boosting efficiency through surrogate metrics and model-based control strategies. This holistic framework, by simultaneously optimizing functionality, durability, and manufacturability, has the potential to enhance reliability and foster broader acceptance of soft robotics, transforming human-robot interactions.
\end{abstract}

\blfootnote{
    This chapter is partly based on \faFileTextO~\emph{\textbf{M. Stölzle}*, N. Pagliarani*, F. Stella, J. Hughes, C. Laschi, D. Rus, M. Cianchetti, C. Della Santina, and G. Zardini (2025). Soft yet Effective Robots via Holistic Co-Design. In Nature Machine Intelligence, \textbf{\emph{Under Review}}}~\citep{stolzle2025soft}.

    % \nth{1}-author contributions: M. Stölzle conceived and led the project and wrote the vast majority of the content presented in this chapter. The other co-first-authors contributed ideas and were responsible for the graphics.

    $^*$M.S. and N.P. contributed equally to this work.
    M.S. conceived and led the project.
    All authors contributed ideas to this perspective.
    M.S., N.P., and F.S. collaborated on the figures and graphics.
    M.S. wrote the majority, and N.P. and F.S. wrote parts of the manuscript.
    All authors revised the manuscript.
    G.Z., C.D.S., M.C., and J.H. supervised the project and provided funding.
}

%% Start the actual chapter on a new page.
\newpage

\input{appendix-holistic-codesign/sections/S01_introduction}
\input{appendix-holistic-codesign/sections/S02_related_work}
\input{appendix-holistic-codesign/sections/S03_holistic_codesign_framework}
\input{appendix-holistic-codesign/sections/S04_reduced_order_design_parametrizations}
\input{appendix-holistic-codesign/sections/S05_probabilistic_codesign_metrics}
\input{appendix-holistic-codesign/sections/S06_codesigning_physical_intelligence}
\input{appendix-holistic-codesign/sections/S07_safety_vs_performance_tradeoff}
\input{appendix-holistic-codesign/sections/S08_conclusion}