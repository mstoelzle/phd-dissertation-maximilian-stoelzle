% \chapter{Learning Low-Dimensional Strain Models of Soft Robots by Looking at the Evolution of Their Shape}
\chapter{Learning Low-Dimensional Strain Models based on the Shape Evolution}
\label{chp:pcsregression}

\begin{foreword}
    % As laid out in Chapter~\ref{chp:background}, dynamical models for soft robots are derived by first settling on a parametrization of its configuration (i.e., by defining the kinematic model). Currently, it is up to the modeling engineer's intuition and trial and error to decide and tune such a model. However, besides deciding on the strain model approach (e.g., \gls{PCC}, \gls{PCS}, \gls{PAC}, \gls{GVS}, etc.), we also need to decide about other model-specific parameters. For example, for kinematics based on the \gls{PCS} approximation, we need to select how many segments the backbone is made up, the length of each segment, and the active strains per segment. Indeed, as we demonstrated already in Chapter~\ref{chp:hsamodel}, these choices (e.g., the active strains) indeed have a significant influence on the accuracy of the shape approximation and, with that, the quality of the dynamic model. Furthermore, there exists inherently a trade-off between the model complexity (i.e., the \gls{DOF} of the model) and the model performance, which is currently not sufficiently appreciated by the soft robotics modeling community.
    % For these reasons, we identify the need for an automated algorithm to analyze the before-mentioned trade-off thoroughly and, based on this analysis, choose a suitable kinematic model.
    % Finally, we desired a method that would enable us to derive a dynamic model and efficiently identify its associated parameters from data.
    % Importantly, during this learning process, we strive to preserve the interpretation and structure of these physics-based models.
    % In this chapter, we present an approach for this problem setting that consists of two steps: first, the \emph{Kinematic Fusion} algorithm automatically identifies a suitable \gls{PCS}-based kinematic parametrization based on pose samples of the backbone shape. Secondly, the \emph{Dynamic Regression \& Sparsification} algorithm allows us to identify the parameters of a physics-based dynamic model in closed form. It simultaneously reduces the model complexity by eliminating strains that can be neglected.
    % This strategy allows us to preserve the full interpretability of a physics-based \emph{white-box} model while learning the associated parameters in a data-driven fashion.
    % 
    As discussed in Chapter~\ref{chp:background}, dynamical models for soft robots are developed by first establishing a parametrization of their configuration (i.e., defining the kinematic model). Currently, the process of selecting and fine-tuning such a model largely relies on the modeling engineer’s intuition and iterative adjustments. Beyond selecting the strain model approach (e.g., \gls{PCC}, \gls{PCS}, \gls{PAC}, \gls{GVS}, etc.), it is also necessary to determine other model-specific parameters. For instance, when using kinematics based on the \gls{PCS} approximation, decisions must be made regarding the number of backbone segments, the length of each segment, and the active strains per segment. As demonstrated in Chapter~\ref{chp:hsamodel}, these choices—such as the selection of active strains—significantly impact the accuracy of the shape approximation and, consequently, the quality of the dynamic model. Moreover, there is an inherent trade-off between model complexity (i.e., the \gls{DOF} of the model) and model performance, a consideration that is currently underappreciated within the soft robotics modeling community.
    To address these challenges, we recognize the need for an automated algorithm that thoroughly analyzes this trade-off and selects an appropriate kinematic model based on the analysis. Additionally, we seek a method capable of deriving a dynamic model and efficiently identifying its associated parameters from data. Crucially, we aim to preserve the interpretability and structure of these physics-based models throughout the learning process.
    In this chapter, as described in Sec.~\ref{sec:pcsregression:methodology}, we propose a two-step approach to tackle this problem. First, the \emph{Kinematic Fusion} algorithm automatically determines a suitable \gls{PCS}-based kinematic parametrization using pose samples of the backbone shape. Second, the \emph{Dynamic Regression \& Sparsification} algorithm identifies the parameters of a physics-based dynamic model in closed form while simultaneously reducing model complexity by eliminating negligible strains. This approach enables us to maintain the interpretability of a physics-based \emph{white-box} model while learning its parameters in a data-driven manner. Finally, it allows us in Sec.~\ref{sub:pcsregression:validation:model_based_control} to leverage P-satI-D+Feedforward controllers, as already applied to the physics-based \gls{HSA} model in Chapter~\ref{chp:hsacontrol}, for model-based shape regulation of the soft robot.
\end{foreword}

\pagebreak

\begin{abstract}
    Obtaining dynamic models of continuum soft robots is central to the analysis and control of soft robots, and researchers have devoted much attention to the challenge of proposing both data-driven and first-principle solutions.
    Both avenues have, however, shown their limitations; the former lacks structure and performs poorly outside training data, while the latter requires significant simplifications and extensive expert knowledge to be used in practice. This paper introduces a streamlined method for learning low-dimensional, physics-based models that are both accurate and easy to interpret. We start with an algorithm that uses image data (i.e., shape evolutions) to determine the minimal necessary segments for describing a soft robot's movement. Following this, we apply a dynamic regression and strain sparsification algorithm to identify relevant strains and define the model's dynamics. 
    We validate our approach through simulations with various planar soft manipulators, comparing its performance against other learning strategies, showing that our models are both computationally efficient and 25x more accurate on out-of-training distribution inputs.
    Finally, we demonstrate that thanks to the capability of the method of generating physically compatible models, the learned models can be straightforwardly combined with model-based control policies.
\end{abstract}

\blfootnote{This chapter is partly based on \faFileTextO~\emph{R. Valadas*, \textbf{M. Stölzle}*, J. Liu, and C. Della Santina (2025). Learning Low-Dimensional Strain Models of Soft Robots by Looking at the Evolution of Their Shape with Application to Model-Based Control. In Proceedings of the 2025 IEEE 8th International Conference on Soft Robotics (RoboSoft) (pp. 1-8). IEEE.}~\cite{valadas2025learning}.
}


%% Start the actual chapter on a new page.
\newpage

\input{pcsregression/sections/S01_introduction}
\input{pcsregression/sections/S02_preliminaries}
\input{pcsregression/sections/S03_methodology}
\input{pcsregression/sections/S04_validation}
\input{pcsregression/sections/S05_conclusion}

\section*{Afterword}
In this chapter, we presented a data-driven approach for identifying strain-based models for continuum soft robots. Crucially, we preserve all insight and physical interpretability into the kinematic and dynamical models, respectively. These features enable us to \emph{debug} the model and apply the fundamentally the same model-based control concepts (e.g., P-satI-D+feedforward) that we previously used in Chapter~\ref{chp:hsacontrol} for the \gls{HSA} robot. Furthermore, the strain distance threshold in the \emph{Kinematic Fusion} algorithm and the maximum stiffness threshold in the \emph{Strain Sparsification} algorithm allow us to make the tradeoff between model complexity and model performance (i.e., shape reconstruction for the kinematic model and prediction accuracy for the dynamic model) explicit.
As we basically derive an entirely \emph{whitebox} model, the dynamic model exhibits excellent extrapolation performance compared to \emph{blackbox} or even \emph{greybox} (e.g., \glspl{LNN}) \gls{SOTA} \gls{ML} techniques.
% However, even though the approach presented in this chapter exhibits excellent performance and generates low-dimensional control-oriented models, it is not sufficient to learn and incorporate very complex soft robot behavior, such as deformations of the backbone cross-sections, which the Cosserat rod model neglects or time-dependent effects such as hysteresis. Additional model features such as nonlinear elasticity, as present for \gls{HSA} robots, could theoretically be backed into the model but could not be automatically detected by the algorithm presented in this chapter.
% Furthermore, as the approach uses a \gls{PCS}-based parametrization which is in turn derived from the Cosserat rod theory, it would exhibit inferior performance for robots where the \emph{slender rod} assumption is not met anymore.
% Finally, the problem setting presented in this chapter considers that pose samples of the shape of the backbone are available.
% However, exteroceptive sensing modalities such as motion capture systems are not practical in a future where we seek soft robots to assist humans with activities of daily living and to extract the backbone shape with computer vision is prone to errors, particularly in situations where tracking of key points along the soft robot body across time is challenging.
% Consequently, we present in Chapter~\ref{chp:con} an approach that leverages a network of the most basic mechanical system (i.e., a harmonic oscillator) for learning latent dynamics from image pixels.
% This approach can be seen as a \emph{greybox} model where both the reduced-order coordinates (approximated by an autoencoder) and the dynamical system (approximated with a \gls{CON}) are learned using modern \gls{ML} techniques but we preserve a mechanical interpretation of both latent variables and latent dynamics. This allows us to analyze the characteristics of the learned latent system (e.g., the kinetic and potential energy) and subsequently also exploit this knowledge for model-based control in latent space.
Although the approach presented in this chapter demonstrates excellent performance and produces low-dimensional, control-oriented models, it cannot capture very complex soft robot behaviors. These include deformations of the backbone cross-sections, which the Cosserat rod model neglects, as well as time-dependent effects such as hysteresis. While features like nonlinear elasticity, observed in \gls{HSA} robots (see Chapter~\ref{chp:hsamodel}), could theoretically be integrated into the model, they currently cannot be automatically identified by the algorithm introduced in this chapter.
Additionally, since the approach relies on a \gls{PCS}-based parametrization derived from Cosserat rod theory, it performs poorly for robots that do not satisfy the \emph{slender rod} assumption. Moreover, the problem setting assumes access to pose samples of the backbone’s shape. However, in scenarios where soft robots are intended to assist humans with daily activities, exteroceptive sensing methods like motion capture systems become impractical. Extracting the backbone shape using computer vision is also prone to errors, especially when tracking key points along the soft robot’s body over time is challenging. 

Therefore, in Chapter~\ref{chp:con}, we propose an alternative approach that employs a network of basic mechanical systems (e.g., a harmonic oscillator) to learn latent dynamics directly from image pixels. This method can be viewed as a \emph{grey-box} model, where both the reduced-order coordinates (approximated by an autoencoder) and the dynamical system (approximated by a \gls{CON}) are learned using modern \gls{ML} techniques. Crucially, this approach retains a mechanical interpretation of both latent variables and their dynamics, enabling analysis of the learned latent system’s properties (e.g., kinetic and potential energy). This insight can then be leveraged for model-based control within the latent space.