\section{Introduction}
% Continuum soft robot's inherent compliance and embodied intelligence make them promising candidates for close collaboration between humans and robots and contact-rich manipulation~\citep{rus2015design, mengaldo2022concise}.
\dropcap{M}odeling the dynamical behavior~\citep{armanini2023soft} of soft robots with computationally tractable models is important for many applications, such as efficient simulation~\citep{alkayas2025soft}, model-based control~\citep{della2023model}, state estimation~\citep{shao2023model}, and co-design~\citep{wang2024diffusebot}. 
%
% To fully exploit their potential, we need to be able to effectively control their dynamic motion.
% The complex and underactuated nature of continuum soft robots renders methods that are able to directly learn the control policy through experience~\citep{chen2024data} (e.g., \gls{RL}~\citep{thuruthel_model-based_2019, bianchi2023softoss, jitosho2023reinforcement}, Iterative Learning control~\citep{pierallini2023provably}) very interesting. However, they usually lack safety guarantees, are sample inefficient, and exhibit poor performance outside their training set distribution.
% Another avenue is to first model the dynamic behavior of the soft robot and subsequently leverage established model-based control techniques such as PD+feedforward~\citep{della2023model} or \gls{MPC}~\citep{alora2023data} to determine the control input.
% 
Developing such (low-dimensional) dynamic models is challenging and is an active area of research~\citep{alora2023data, armanini2023soft}. The use of data-driven approaches has been extensively investigated in this context~\citep{thuruthel2017learning, bruder2020data, alora2023data, chen2024data}.
These learned models exhibit poor extrapolation performance~\citep{kim2021review}, a lack of interpretability and (physical) structure preventing us from directly leveraging closed-form control solutions such as the PD+feedforward~\citep{della2023model}. Instead, researchers had to fall back to computationally expensive planning methods such as \gls{MPC}~\citep{bruder2020data, alora2023data}.

The traditional avenue established by the robotics and continuum dynamics communities has been to derive the dynamical model directly from first principles~\citep{renda2018discrete, boyer2020dynamics, della2023model, armanini2023soft} % more citations:  grazioso2019geometrically, gazzola2018forward
which provides physical interpretability and structure at the cost of needing substantial expert knowledge, for example in the selection of the proper kinematic approximations (e.g., \gls{PCC}~\citep{webster2010design}, \gls{PCS}~\citep{renda2018discrete}, \gls{GVS}~\citep{boyer2020dynamics}). % and the faithful integration of its geometrical, inertial, and elastic characteristics~\citep{armanini2023soft}.
%Any suboptimal choices or \emph{mistake} in this approximation \& modeling procedure can have significant consequences, such as inaccurate predictions and/or models that are too highly dimensional.
%We also point out that this prevents the democratization of soft robots~\citep{aracri2024soft} as only specialized research laboratories have access to the necessary know-how and experience. 
%
Suboptimal choices or even errors in applying this modeling procedure can lead to significant issues like inaccurate predictions and overly complex models. This hinders the democratization of soft robots, as only specialized research labs possess the required expertise~\citep{aracri2024soft}.

Very recently, there has been a community push towards integrating physical structures and stability guarantees into learned models (e.g., Lagrangian Neural Networks~\citep{liu2024physics}, residual dynamical formulations~\citep{bruder2024koopman, gao2024sim}, or oscillatory networks~\citep{stolzle2024input}) which combine benefits from both worlds: they are learned directly from data which reduces the expert knowledge that is needed but at the same time exhibit a physical structure that can be exploited for model-based control and stability analysis.
This work positions itself in this new trend of research, specifically focusing on deriving kinematic and dynamic models for continuum soft robots in a data-driven way.
%, which we believe is potentially capable of overcoming the limitations of 
%
% We adopt a similar approach, focusing on 
%


%We follow a similar philosophy but focus on deriving kinematic and dynamic models in a data-driven fashion that are specialized to continuum soft robots. 
%In particular, we propose an algorithm that can identify both the structure and parameters of the expressive \gls{PCS} model~\citep{renda2018discrete}.
%The \gls{PCS} model is both established and frequently used in the soft robotic literature and divides the soft robot's structure into segments, each assumed to have constant strain. Sometimes, the soft robot's design makes it possible to neglect some of the strains (e.g., \gls{PCC} model~\citep{webster2010design}). % For example, the popular \gls{PCC} model~\citep{webster2010design} neglects all strains but bending.
%
Indeed, deriving reduced-order kinematic representations remains the core challenge in physics-based modeling. 
%
Previous works have relied heavily on the modeling engineer's intuition and experience to make decisions on the number of \gls{PCS} segments, the length of each segment, and which strains to consider~\citep{toshimitsu2021sopra}. However, these decisions are not straightforward and could easily result in models that are higher-dimensional than necessary or that important strains are ignored based on a wrong intuition~\citep{garg2022kinematic}.
Very recently, \citet{alkayas2025soft} proposed a data-driven algorithm to identify the optimal \gls{GVS}~\citep{boyer2020dynamics} strain parametrization of continuum soft robots via Proper Orthogonal Decomposition (POD). However, as it tailored towards regressing coefficients of continuous basis functions, it requires access to prior knowledge about the terminal points of actuators for accurately capturing strain discontinuities.
Furthermore, identifying the dynamical parameters (e.g., stiffness, damping coefficients) of the soft robot required solving a nonlinear least-squares problem that is not always well behaved~\citep{stolzle2024experimental}.

This paper proposes to solve these challenges by introducing an end-to-end approach that can automatically learn both a \gls{PCS} kinematic parametrization and the corresponding dynamical model, including its dynamic parameters directly from image/Cartesian pose data.
First, a kinematic fusion algorithm aims to minimize the \glspl{DOF} of the \gls{PCS} kinematic model while preserving a desired shape reconstruction accuracy for the given discrete shape measurements in Cartesian space. In contrast to previous work~\citep{alkayas2025soft}, we do not necessitate prior knowledge about strain discontinuities.
Secondly, an integrated strategy is proposed to simultaneously sparsify the strains of the \gls{PCS} model and estimate the parameters of the dynamical model with closed-form linear least-squares.
Contrary to common symbolic regression approaches such as SINDy~\citep{kaiser2018sparse}, we crucially preserve the (physical) structure of the Euler-Lagrangian dynamics as derived according to the \gls{PCS} model.
This feature allows the derived dynamical model to be subsequently rapidly deployed within established model-based controllers~\citep{della2023model}.

% We verify the approach in simulation in diverse scenarios, including various underlying \emph{real} kinematics (e.g., \gls{PCC}, \gls{PAC}, etc.), different soft robot topologies (i.e., different number of segments), and including process and measurement noise.
We verify the approach in simulation in a diverse set of scenarios, including different robot topologies and the performance when measurement noise is present. Impressively, the method is able to accurately perform long-horizon (\SI{7}{s}) shape predictions when being trained on \SI{4}{s} of trajectory data.
%Furthermore, we present examples of Pareto fronts that describe the tradeoff between the \gls{DOF} of the kinematic model and the shape reconstruction accuracy. Analyzing this tradeoff allows the user to choose their \emph{sweetspot} between model complexity and performance.
We benchmark the proposed approach against several state-of-the-art dynamical model learning approaches (e.g., \glspl{NODE}, \gls{CON}, \glspl{LNN}). On the training set, our proposed method exhibits a \SI{70}{\percent} lower shape prediction error than the best-performing baseline method (\gls{NODE}).
However, we find that the difference is even greater in extrapolation scenarios (i.e., actuation sequences and magnitudes unseen during training): Here, our proposed method reduces the shape prediction error on the test set by \SI{96}{\percent} compared to the best performing \gls{ML} baseline (\gls{NODE}).
% We also exhibit the significantly improved extrapolation performance.
Finally, we demonstrate how the Lagrangian structure of the identified dynamical model allows us to easily design a model-based controller that is effective at regulating the shape of the soft robot.

A video attachment presents the research idea \& methodology and contains supplementary plots and animations of the results presented in the paper.\footnote{{\small \url{https://youtu.be/dfO-PhDIiHI}}}