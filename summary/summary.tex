\chapter*{Summary}
\addcontentsline{toc}{chapter}{Summary}
\setheader{Summary}

% Contents of summary:
% \begin{itemize}
%     \item problem and gap (social or scientific relevance) (Introduction)
%     \item thesis aim / main question (Introduction)
%     \item method (Introduction)
%     \item main results (Core chapters)
%     \item conclusion, possible applications, implications
% \end{itemize}

% As we work towards bringing robotics into human-centric environments, safety is paramount. However, today, safety is mostly ensured through computational control policies, which makes it susceptible to perception error and often leads to overly cautious behavior, limiting the robot's performance. Instead, soft robotics promises to improve safety by establishing passive compliance of the entire body through material softness. This \emph{embodied intelligence} is not negatively influenced by perception or control errors. There has been tremendous progress in the last few years in the domain of soft robotics, with new designs, smart materials, actuators, sensors, models, and control approaches being proposed by the research community. In particular, the modeling and control of continuum soft robots is very challenging as they theoretically have infinite degrees of freedom, exhibit complex nonlinear dynamics, and even time-dependent behavior such as hysteresis. Currently, two approaches for control are dominant: model-based control based on physics-based models derived from first principles under significant approximations and learned control policies, mainly by means of reinforcement learning.
% However, there exist major issues with both approaches: i) existing model-based controllers are unable to exploit the full dynamic of soft robots as their underlying models do not sufficiently capture the complex dynamic behavior of soft robots, specifically concerning the influence of actuation and external interaction on the soft robot's deformation, and require expert knowledge in order to meet suitable and appropriate model design choice. On the other side, ii) reinforcement learning does not offer interoperability and stability guarantees and is additionally very sample inefficient, which is an issue when considering the time-dependent material properties and currently limited lifetime of soft robots. 
% Therefore, this thesis argues that a promising alternative approach would be to combine learned models with model-based controllers, which would combine benefits from both worlds: expressive models that require less expert knowledge derived from data combined with controllers whose behavior is interpretable and provably stable.
% The primary challenge for achieving this solution is to identify the necessary characteristics and structures that a learned model needs to exhibit in order to allow us to apply the existing model-based control strategies, such as PID-like feedback+feedforward while making sure that the closed-loop robot system exhibits compliant and safe behavior.
% We tackle this complex challenge in this doctoral thesis through multiple interconnected key contributions:
% 1) leveraging kinematic models for soft robot shape sensing, for example, based on the readout of visual or magnetic sensors, allows us to receive more accurate estimates of the soft robot's state, which is a requirement for effective feedback control; 2) we develop advanced physics-based actuation models, such as modeling the behavior of robots that are actuated through auxetic metamaterials or considering the actuation dynamics of piston-driven pneumatic soft robots;
% 3) we identify techniques that allow us to learn soft robot models with physical structures and stability guarantees. Two of the approaches that we propose are a) an algorithm that identifies low-dimensional, physics-based strain models based on samples of the shape evolution of the robot's backbone and b) a network consisting of coupled harmonic oscillators for learning the latent dynamics of a physical system from high-dimensional observations such as images. The physical structure that is exposed by both approaches allows us to integrate the model into a PID-like feedback controller with potential shaping serving as the feedforward term;
% 4) finally, as a means of moving beyond low-level control, we propose two approaches for generating compliant motion behaviors for soft robots. The first approach, i), is tailored to assist the user, for example, elderly people, with activities of daily living and allows the user to guide the goal of the low-level controller via their thoughts. To achieve a compliant control behavior, we combine motor imagery classified based on the data measured by wearable EEG devices with compliant impedance control in Cartesian space. The second approach, ii) combines an orbitally stable dynamical system in latent space with a bijective neural-network parametrized encoder for learning periodic motions from demonstrations. As the learned motion policy does not rely on a time reference, it allows for natural and compliant tracking of the demonstrated motion.
% The behaviors of some models and controllers have been analyzed theoretically in terms of stability characteristics.
% The models, sensing, control, and motion strategies developed in this thesis have been extensively validated both in simulation and on real-world (soft) robots. The code and data of most chapters have been open-sourced on GitHub.

% As we work towards integrating robotics into human-centric environments, safety remains a paramount concern. While safety is traditionally ensured in rigid robotics through safety-aware computational control policies, this approach is vulnerable to perception errors and often results in overly cautious behavior that limits robot performance. Soft robotics presents a promising alternative by establishing passive compliance throughout the entire robot body through material softness. This mechanical compliance is inherently resistant to perception or control errors. Recent years have witnessed remarkable progress in soft robotics, with researchers developing new designs, smart materials, actuators, sensors, models, and control approaches. However, the modeling and control of continuum soft robots still present significant challenges due to their infinite degrees of freedom, complex nonlinear dynamics, and time-dependent behaviors such as hysteresis. This leads to soft robots that are not sufficiently capable and specifically precise in their motions, making us again sacrifice performance to gain safety. The goal of this thesis is to overcome this tradeoff by combining learned models with efficient model-based control approaches.
As we increasingly strive to integrate robots into human-centric environments, safety is a top priority. Traditionally, rigid (collaborative) robots have relied on safety-aware computational control policies, which are susceptible to perception errors and often lead to overly cautious behavior that limits performance. In contrast, soft robotics offers a promising alternative by ensuring passive compliance throughout the robot’s structure via material softness. This mechanical compliance inherently mitigates issues arising from perception or control errors. In recent years, significant advances have been seen in soft robotics, with exciting new developments in design, smart materials, actuators, sensors, models, and control strategies. However, the modeling and control of continuum soft robots continue to pose major challenges due to their infinite degrees of freedom, complex nonlinear dynamics, and time-dependent behaviors like hysteresis. As a result, soft robots often lack the necessary capability and motion precision, leading to a tradeoff where performance is sacrificed for safety. The goal of this thesis is to overcome this tradeoff by combining powerful learned models with efficient model-based control approaches that allow for interpretability into the actions and exhibit stability guarantees.

% Currently, two dominant approaches exist for controlling soft robots. The first relies on model-based control using physics-based models derived from first principles under significant approximations. The second directly learns control policies, primarily through reinforcement learning. Both approaches face substantial limitations. Existing model-based controllers cannot fully exploit the dynamics of soft robots as their underlying models inadequately capture complex dynamic behavior, particularly regarding how actuation and external interaction influence the robot's deformation.
% Furthermore, the derivation of these models also requires considerable expert knowledge.
% Finally, the inherent complexity and uncertainty of joined dynamics consisting of the soft robot and its environment make it (currently) infeasible to develop such complex world models from first principles, motivating the need to integrate \gls{ML} approaches that can effectively leverage knowledge contained in data.
% Conversely, directly learning the controller, for example, via reinforcement learning, lacks interpretability into the decision making and stability guarantees while being highly sample inefficient -- a significant drawback given the time-dependent material properties and limited lifetime of current soft robots.
Currently, two main approaches exist for controlling soft robots. The first employs model-based control using approximated physics-based models derived from first principles. The second directly learns control policies, primarily through reinforcement learning. Both strategies face notable limitations. Existing model-based controllers are unable to fully exploit the dynamics of soft robots because their underlying models inadequately capture complex behaviors, particularly how actuation and external interactions affect the robot’s deformation. Moreover, deriving these models requires extensive expert knowledge. Additionally, the combined complexity and uncertainty of the dynamics between a soft robot and its environment make it currently infeasible to develop comprehensive world models from first principles alone, thereby motivating the integration of \gls{ML} approaches that can effectively leverage data-driven insights. Conversely, directly learning the controller — such as via reinforcement learning — lacks interpretability and stability guarantees while being highly sample inefficient, a significant drawback given the time-dependent material properties and limited lifespan of current soft robots.

% The primary challenge lies in identifying the necessary characteristics and structures that a learned model must possess to enable the application of existing closed-form model-based control strategies, such as PID+potential-shaping while ensuring the closed-loop robot system maintains compliant, stable, and safe behavior.

% With this thesis, we argue that combining learned models with model-based controllers offers a promising alternative approach, uniting the benefits of both methods: expressive models derived from data requiring less expert knowledge coupled with controllers whose behavior is both interpretable and provably stable. 
% While in recent years, there has been increased research interest in leveraging learned models for control, most works rely on computationally demanding optimal control approaches, such as \gls{MPC}, to optimize the actuation sequence. However, the computational complexity of solving this optimal control problem limits the maximum control rate during deployment not allowing us to exploit the dynamic capabilities of soft robots fully.
% Instead, we pursue in this thesis closed-form controllers that leverage the physical structure of learned models within an energy-shaping feedforward term.
% The primary challenge here lies in devising approaches for incorporating such physical structures (specifically kinetic and potential energy terms) into the learning of dynamical models of soft robots.
In this thesis, we contend that combining learned models with model-based controllers presents a promising alternative that brings together the advantages of both approaches: expressive, data-driven models that require less expert knowledge paired with controllers that are both interpretable and provably stable. Although recent years have seen increased interest in leveraging learned models for control, most work in this area depends on computationally intensive optimal control methods, such as \gls{MPC}, to optimize the actuation sequence with the learned model. However, the high computational cost of solving these optimal control problems limits the maximum control frequency during deployment, preventing us from fully exploiting the dynamic capabilities of soft robots. Instead, this thesis pursues closed-form controllers that utilize the physical structure of learned models within an energy-shaping feedforward term. The main challenge here is to develop approaches that integrate such physical structures—specifically, kinetic and potential energy terms—into the learning of dynamical models for soft robots.
The thesis addresses this complex challenge through several interconnected key contributions. 

First, we argue that quantifying the safety of soft robots is crucial for designing and controlling them to ensure that the closed-loop system meets the specific safety requirements of their intended applications. To this end, we present the first safety metric for continuum soft robots, which assesses the safety of an integrated soft robot design by accounting for both its embodied and computational intelligence.

% Secondly, this thesis advances kinematic models for soft robot shape sensing, utilizing visual or magnetic sensor readings to obtain more accurate estimates of the soft robot's state—a crucial requirement for effective feedback control.
% Secondly, this thesis improves shape sensing for soft robots by leveraging kinematic model knowledge. We achieve this by formulating and solving nonlinear optimization problems that reconcile sensor measurements with the attainable backbone shapes by the kinematic model.
% We develop two distinctive approaches that combine commercial sensors, specifically visual and magnetic sensors, with a \gls{SLAM} algorithms and a learned sensor measurement model, respectively, to estimate the soft robot's state—a crucial requirement for effective feedback control.
Secondly, this thesis enhances shape sensing for soft robots by leveraging insights from kinematic models. We accomplish this by formulating and solving nonlinear optimization problems that align sensor measurements with the backbone shapes predicted by the kinematic model. We present two distinct approaches that integrate commercial sensors—namely visual and magnetic—with SLAM algorithms and a learned sensor measurement model, respectively, to accurately estimate the soft robot’s state, a key requirement for effective feedback control.

% Thirdly, the thesis develops sophisticated physics-based actuation models, including those for robots actuated through auxetic metamaterials, called \gls{HSA} robots, and models accounting for the actuation dynamics of piston-driven pneumatic soft robots. Subsequently, we exploit the gained model knowledge within provably stable nonlinear controllers - namely, an integral-saturated PID+potential shaping and Cartesian-space impedance control for planar \gls{HSA} robots and a backstepping controller for pneumatic piston-driven soft robots.
% This contribution highlights the control-oriented structure of physics-based models, which will be utilized in the subsequent contribution. Additionally, the research underpinning this contribution reveals the current limitations regarding the complexity and computational demands of physics-based models, thereby motivating the exploration of potentially more computationally efficient neural network-parametrized models.
% This contribution improves our understanding of an essential ingredient of soft robot behavior - the actuation - and demonstrates how such knowledge can be leveraged within model-based control approaches.
% Furthermore, the work with \gls{HSA} robots demonstrated some of the limitations of fully physics-based models at capturing very complex characteristics such as hysteresis, motivating the exploration of learning-based approaches. In the future, the actuation models developed as part of this contribution can serve as strong physical priors for learned models.
Thirdly, this thesis introduces advanced physics-based actuation models, including those for robots actuated by auxetic metamaterials —- referred to as \gls{HSA} robots—and models that capture the actuation dynamics of piston-driven pneumatic soft robots. We then leverage the acquired model insights to design provably stable nonlinear controllers—specifically, an integral-saturated PID combined with potential shaping and Cartesian-space impedance control for planar \gls{HSA} robots, as well as a backstepping controller for pneumatic piston-driven soft robots. This contribution deepens our understanding of actuation, a critical aspect of soft robot behavior, and demonstrates how such insights can be incorporated into model-based control strategies. Moreover, experiments with \gls{HSA} robots have highlighted the limitations of purely physics-based models in capturing complex phenomena like hysteresis, thereby motivating the exploration of learning-based approaches. In the future, the developed actuation models can serve as valuable physical priors for learned models.

% Fourthly, the thesis identifies techniques for learning soft robot models with physical structures and stability guarantees. 
% We achieve this by integrating physics-based dynamical models into the learning algorithm which determines the free parameters of the dynamics and optimally optimizes over a change of coordinates, such as an encoding into latent space.
% Two notable approaches are presented: (1) an algorithm that identifies low-dimensional, soft robot strain models using samples of the robot backbone's shape evolution and (2) a network of coupled harmonic oscillators for learning latent dynamics of physical systems from high-dimensional observations such as images. 
% The kinematic and potential energy terms of the learned models allow for stability analysis using standard tools from nonlinear system theory (e.g., Lyapunov arguments).
% For example, we prove that the presented coupled oscillator network is globally asymptotically stable and input-to-state stable.
Fourthly, the thesis presents techniques for learning soft robot models that incorporate physical structures while ensuring stability. We accomplish this by embedding physics-based dynamical models into the learning algorithm, which determines the free parameters of the dynamics and optionally optimizes a coordinate transformation—such as encoding into latent space. Two notable approaches are introduced: (1) an algorithm that extracts low-dimensional soft robot strain models from samples of the robot backbone’s shape evolution, and (2) a network of coupled harmonic oscillators for learning latent dynamics from high-dimensional observations like images. The explicit inclusion of kinematic and potential energy terms in these models allows for stability analysis using standard nonlinear system theory tools, such as Lyapunov methods. For instance, we prove that the coupled oscillator network is both globally asymptotically stable and input-to-state stable.

% The physical structure exposed by both approaches enables their integration into PID-like feedback controllers with potential shaping as the feedforward term.
% Fifthly, we leverage the physical structure of the learned models from contribution four to devise closed-form setpoint regulators. The controller consists of (1) a potential shaping feedforward term that ensures that the local/global minimum of the potential energy is at the setpoint leveraging the learned model knowledge and (2) an integral-saturated PID as the feedback term for rejecting disturbances and counteracting modeling errors preventing steady-state errors.
% The stability of the closed-loop system can be again analyzed using Lyapunov methods.
Fifthly, we exploit the physical structure of the learned models from contribution four to design closed-form setpoint regulators. The controller contains two key components: (1) a potential shaping feedforward term that positions the local/global minimum of the closed-loop potential energy at the setpoint by leveraging the learned model knowledge, and (2) an integral-saturated PID feedback term that rejects disturbances and compensates for modeling errors to prevent steady-state errors. The stability of the closed-loop system can then be analyzed using Lyapunov arguments.


Finally, the thesis explores methods for generating compliant motion behaviors in soft robots beyond low-level control. One approach focuses on assisting users, particularly elderly individuals, with activities of daily living by guiding the low-level controller with brain signals. This is achieved by combining motor imagery classification from wearable EEG devices with compliant impedance control in operational space. The second approach combines an orbitally stable dynamical system in latent space with a bijective neural network parametrized encoder to learn periodic motions from demonstrations. By avoiding reliance on time references, this learned motion policy enables natural and compliant tracking of demonstrated periodic motions. This contribution ensures that not just the robot structure and low-level controller are compliant but also the high-level motion strategy.

% The thesis includes a theoretical analysis of the stability characteristics of several models and controllers. All proposed models, sensing methods, control strategies, and motion approaches have undergone extensive validation through either simulation or real-world testing on soft robots. Additionally, the code and data from most chapters have been made publicly available through GitHub, contributing to the broader research community's ongoing work in this field.


% Conclusion about the core contribution:
% \begin{itemize}
%     \item Goal of this thesis: safe and precise soft robot behavior. Safety is increase by the soft body and learned models can more accurately capture complex dynamics, leading to hopefully increased precision in the future.
%     \item In summary, we proposed strategies for learning dynamics that... and that allow for closed-form model-based control, which is computationally very efficient. 
%     \item Verified in simulation and code is available online
%     \item Limitations include lack of experimental validation, focus on setpoint regulation, no underactuated setting, no environment interactions, no explicit accounting for safety in control
% \end{itemize}

% In summary, the goal of this thesis is to work towards safe and precise soft robot behavior in human-centric environments.
% Here, the safety is contributed by the soft body with its mechancial compliance (both on a structural and surface level).
% To increase the precision of soft robots while preserving insight into the decision-making, stability guarantees, and computational efficiency, the thesis's core contribution is the development of closed-form soft robot controllers based on learned models. Specifically, we propose to leverage the physical structure of learned models within a setpoint regulation controller consisting of an integral-saturated PID as the feedback term and a potential shaping feedforward term.
% To enable this, we developed two \gls{ML} approaches which allow us to express the kinetic and potential energy of the learned dynamics.
% Several contributions support this core contribution, such as a metric to quantify the safety of soft robots, strategies for integrating kinematic models into shape sensing approaches, advanced physics-based actuation models which can serve in the future as additional priors on the learned models, and moving one level above low-level control compliant motion generation strategies for soft robots.
% All proposed models, sensing methods, control strategies, and motion approaches have undergone extensive validation through either simulation or real-world testing on soft robots.
% The code and data from most chapters have been made publicly available on GitHub, contributing to the broader research community's ongoing work in this field.
% Limitations of the core contribution include a lack of experimental validation of the model learning and the control with learned models, that the trajectory tracking and underactuated settings are currently not considered, that the model learning does not (explicitly) account for environment interactions, and that the proposed controller does not directly consider the safety of the closed-loop system (i.e., the controller is not safety-aware)
In summary, this thesis aims to work towards safe and precise soft robot behavior in human-centric environments. In this context, safety is achieved through the soft body’s mechanical compliance. To enhance precision while maintaining insight into decision-making, ensuring stability, and preserving computational efficiency, the core contribution of this work is the development of closed-form soft robot controllers based on learned models. Specifically, we propose leveraging the physical structure inherent in these learned models within a setpoint regulation controller that combines an integral-saturated PID feedback term with a potential shaping feedforward term. To facilitate this, we developed two \gls{ML} approaches that enable us to express the kinetic and potential energy of the learned dynamics. Several supporting contributions include a metric for quantifying the safety of soft robots, strategies for integrating kinematic models into shape sensing methods, advanced physics-based actuation models that could serve as future priors for learned models, and moving beyond low-level controllers by devising compliant motion strategies. All proposed models, sensing methods, control strategies, and motion approaches have been thoroughly verified through simulation or real-world testing on soft robots. Additionally, the code and data from most chapters have been made publicly available on GitHub, thereby contributing to the broader research community. Limitations of the core contribution include a lack of experimental validation for both the model learning and the control with learned models, the current omission of trajectory tracking and underactuated scenarios, the fact that the model learning does not explicitly account for environmental interactions and that the proposed controller does not explicitly consider the safety of the closed-loop system.



% \chapter*{Samenvatting}
% \addcontentsline{toc}{chapter}{Samenvatting}
% \setheader{Samenvatting}

% {\selectlanguage{dutch}

%   Samenvatting in het Nederlands.
% }

% \chapter*{Zusammenfassung}
% \addcontentsline{toc}{chapter}{Zusammenfassung}
% \setheader{Zusammenfassung}

% {\selectlanguage{german}

%   Zusammenfassung in Deutsch.
% }



