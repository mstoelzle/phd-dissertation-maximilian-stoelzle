\section{Thesis Contributions}\label{sec:introduction:contributions}

In the following, we will detail the key contributions made by this dissertation.
We start with the core contribution, which addresses the \emph{principal \gls{RQ}}.

% \begin{large}
\begin{titled-frame}{\textbf{Core Contribution}}
% \noindent Safe Closed-form Control of Soft Robots with Learned Models
\noindent Safe and Precise Soft Robots via Closed-form Control with Learned Models
% compliant, stable, and efficient?
\end{titled-frame}
% \end{large}
In this thesis, we devised two approaches for learning kinematic and dynamic models of soft robots that exhibit a physical structure, which we go into more detail about when discussing Contribution~\ref{contrib:learned_models}. As these learned models press well-defined kinetic and potential energy terms, we can leverage well-established feedback+feedforward control strategies originally developed for rigid manipulators~\cite{kelly1995tuning, kelly1996class, kelly1998global, sciavicco2012modelling}.
Specifically, we combine a potential-shaping feedforward term~\cite{della2023model} with an integral-saturated PID~\cite{pustina2022p} as the feedback term. This control strategy allows us to exploit the learned model knowledge in the feedforward term while simultaneously rejecting disturbances and compensating modeling errors with the feedback term.
Furthermore, instead of devising the controller via computationally expensive strategies such as \gls{RL} or \gls{MPC} as it typically needs to be done for learned models, the control input is available in closed form.
Also, this strategy would allow us to inspect the stability of the closed-loop system and prove its stability using Lyapunov arguments~\cite{khalil2002nonlinear}, as we have already done for the open-loop system~\cite{stolzle2024input}.
These stability guarantees enabled by the interpretability of the learned model are already one step towards ensuring \emph{safe control}. To advance and quantify the safety of soft robot control, we furthermore i) devise a safety metric that allows an analysis of the injury severity that could be caused by the closed-loop system and, particularly, establishing limits on the magnitude of the (proportional) feedback gains to meet the given safety requirements, and ii) develop stable high-level strategies for generating compliant motion behaviors by providing references/setpoints to the low-level controller.

This core contribution is enabled by multiple key contributions, which we detail in the following.

\begin{contribution}\label{contrib:safety_metric}
    A First Quantitative Safety Metric for Soft Robots
\end{contribution}
In order to answer \gls{RQ}~\ref{rq:soft_robotic_safety}, we devise the first quantitative safety metric for soft robots in Chapter~\circled{\ref{chp:safetymetric}}.
To achieve this goal, we first investigate potential applications in the realm of design, control, and certification of such a safety metric. Subsequently, we state a list of requirements that a safety metric would need to (ideally) meet in order to be suitable for these applications.
Finally, based on the existing, standardized criterion for collaborative robots~\cite{Isots_15066_2016}, which considers the maximum contact experienced during a collision between a robot and human as a proxy for injury severity, we devise a quantitative safety metric that takes into account the particular characteristics of soft robots, such as dynamics that consider the continuous deformability of the backbone, elasticity, and contact anywhere along its body.
The proposed safety metric comes in two flavors: the \gls{ISC} models the injury severity for a given contact geometry, soft robot configuration, and velocity. The \gls{DHC} assess the safety of a soft robotic design under the given operating conditions, such as maximum velocity, maximum actuation torques, etc.
Finally, we give recommendations for the safe design of soft robotic manipulators.

% \subsection{Leveraging Kinematic Models for Soft
% Robot Shape Sensing}
\begin{contribution}\label{contrib:kinematic_models_shape_sensing}
    Leveraging Kinematic Models for Soft Robot Shape Sensing    
\end{contribution}
This contribution towards answering \gls{RQ}~\ref{rq:shape_sensing} enables more robust and accurate shape sensing for soft robots by exploiting existing kinematic model knowledge. This improved state estimation is required for the deployment of feedback controllers, and it thus directly contributes to the core contribution of this thesis.
Below, we detail two approaches that make up this contribution.

In the first, fully learning-free, method presented in Chapter~\circled{\ref{chp:srslam}}, we leverage a monocular visual \gls{SLAM} algorithm to obtain multiple pose measurements distributed along the soft robotic backbone from camera images. Subsequently, we formulate an optimization problem that projects these samples of the soft robot's shape onto the kinematic model to obtain configuration estimates. This helps to limit the effects of estimation drift on the shape belief and ensures that we preserve consistency between the pose estimates and the kinematic model. 
We verify the proposed algorithm both with a simulated \gls{CC} segment and on a real soft segment with an attached low-cost Raspberry Pi camera.
A major benefit of this approach is that very good shape reconstruction performance is enabled by the combination of four already very established components: 1) low-cost monocular cameras, 2) \gls{vSLAM}, 3) the \gls{PCC}~\cite{webster2010design} kinematic model for soft robots, and 4) optimization based on the Levenberg-Marquardt algorithm~\cite{levenberg1944method, marquardt1963algorithm}.
In the future, shape estimation performance could be (likely) very easily improved by, for example, replacing the used \gls{vSLAM} algorithm with the current \gls{SOTA} algorithm or by using more expressive kinematic parametrizations (e.g., \gls{GVS}~\cite{renda2020geometric}).


The second approach appears in Chapter~\circled{\ref{chp:promasens}} and considers shape proprioception based on magnetic sensors. 
Specifically, we propose to embed multiple magnets and magnetic sensors into 
As magnetic fields in 3D can be very complex, a pure physics-based approach is not sufficient anymore. Therefore, we employ modern \gls{ML} approaches to aid us in the interpretation of the magnetic sensor readings. However, instead of learning the mapping from sensor readings to configuration estimates end-to-end, we leverage the kinematic model to simplify the learning problem and improve the data efficiency. Specifically, we use the kinematic model describing the backbone shape to parametrize the spatial relationship between a magnetic sensor and each magnet through a set of a few variables. 
This then allows us to efficiently and robustly learn to predict the measurements of the magnetic sensor using a neural network. During inference, we then formulate an optimization problem that aims to estimate the soft robot shape by matching the actual and the predicted sensor measurements, which we solve through gradient descent.
This approach demonstrates how existing prior knowledge, such as a kinematic model, can be used to reduce the size of the \emph{black-box}.


\begin{contribution}\label{contrib:actuation_models}
    Control with Advanced Physics-based Actuation Models for Soft Robots
\end{contribution}
We address \gls{RQ}~\ref{rq:actuation_models} by deriving advanced actuation models from first principles and subsequently leveraging them in model-based controllers by considering two cases, namely \gls{HSA} robots, and pneumatic piston-driven soft robots. We detail each case in the following paragraphs.
\textcolor{orange}{How does this contribute to the core contribution?}

\gls{HSA} robots~\cite{lipton2018handedness, chin2018compliant} consist of multiple (usually four) \gls{HSA} rods that are composed in a parallel fashion and connected at the tip. An elongation of the rods causes the robot to elongate and/or bend. However, instead of directly applying axial forces and rotational torques to infuse elongation and bending strains as it is usually done with most soft robot actuation techniques, these deformations are generated by the auxetic metamaterial of the \gls{HSA} rods: applying a torsional torque, for example by attaching an electric servo motor, at the base while constraining the tip causes the rods to twist which in turn is simultaneously transformed by the auxetic metamaterial into elongation of the rod.
Furthermore, the applied torsional torques can cause the entire \gls{HSA} segment to twist, which is a rare deformation for soft robots.
This complex actuation technique calls for the development of completely new, specifically actuation, models. However, while related work in recent years has proposed new designs~\cite{good2022expanding, good2025torque}, fabrication techniques~\cite{truby2021recipe}, proprioception algorithms~\cite{zhang2022vision}, and applications~\cite{chen2024real} for \gls{HSA} robots, accurate models~\cite{garg2022kinematic} and control concepts are still missing. In Chapters~\circled{\ref{chp:hsamodel}} \& \circled{\ref{chp:hsacontrol}}, we propose and experimentally verify several models and controllers for \gls{HSA} robots, respectively. In the following, we will introduce the contributions in more detail.
In Chapter~\circled{\ref{chp:hsamodel}}  of this thesis, we propose new kinematic, dynamic, and actuation models that are tailored to \gls{HSA} robots.
First, we propose a novel kinematic parameterization, the \gls{SPCS} model, that is able to capture the 3D shape of \gls{HSA} rods with the least possible \gls{DOF}.
For this purpose, we combine the existing \gls{CS} and \gls{PCS} models~\cite{renda2018discrete} and keep certain strains constant over the entire \gls{HSA} rod length while allowing other strains to vary in a piecewise constant fashion.
Secondly, as existing work had already experimentally established that the mechanical characteristics, such as stiffness and rest length, of \gls{HSA} rods vary as a function of the actuation (i.e., the twist angle of the rod at the base), we develop a model that is able to capture this particular actuation characteristic and allows easy integration into existing dynamical models/simulators that are based on the \gls{DCM}.
Thirdly, we implement the second contribution into an extension of PyElastica~\cite{naughton2021elastica} that is able to simulate the behavior of \gls{HSA} robots in 3D.
Fourthly, we derive a kinematic parameterization based on the \gls{CS} model that accurately captures the deformation of planar \gls{HSA} robots with just three configuration variables. In this realm, we also state for the first time a closed-form solution for the inverse kinematics of a \gls{CS} robot.
Fifthly, we devise a dynamical model for planar \gls{HSA} robots in Euler-Lagrangian form.
Subsequently, we exploit in Chapter~\circled{\ref{chp:hsacontrol}} the proposed models for control. Specifically, we propose two control approaches:
Firstly, we devise a configuration-space P-satI-D+potential shaping regulator that combines an integral-saturated PID controller~\cite{pustina2022p} with compensation of steady-state forces at the desired setpoint, and that is able to move the end-effector of the planar \gls{HSA} robot towards a desired position in task-space.
A core challenge here was to develop the necessary to make this more complex actuation model usable within the feedback+feedforward strategy. This, for example, required i) linearization of the actuation terms, 2) a mapping into actuation coordinates~\cite{pustina2024input}, and 3) solving the static inversion problem~\cite{della2025pushing}.
Secondly, we propose and experimentally verify a task-space impedance controller that cancels the existing soft robot dynamics based on the model knowledge and allows the shaping of the stiffness field through a Cartesian-space PD feedback term. The key challenge here was a) to derive the operational-space dynamics of the \gls{HSA} robot~\cite{khatib1987unified, della2020model} and b) to map desired generalized torques into the underactuated control input.


Pneumatic/fluidic actuation for soft robots is widely adopted for its fast response time and high and distributed forces/torques~\cite{marchese2015recipe, zaidi2021actuation}.
While there exist several options for fluidic pressure supplies, such as rotary pumps or high-pressure supplies combined with valve-enabled pressure actuators, fluidic drive cylinders/pistons~\cite{marchese2014design, marchese2016design, parlikar2024concept, malas2024novel} have the advantages of i) a direction relationship between soft robot deformation and piston position and ii) a closed-volume system~\cite{marchese2016design}.
However, there exists only relatively little research on modeling the behavior of such pneumatic piston-driven soft robots~\cite{marchese2014design, xavier2020modelling}.
Furthermore, existing model-based soft robot controllers~\cite{della2020model, della2023model} do not take the dynamics of the actuator into account but instead rely on a cascaded control scheme where an outer loop running a (configuration-space) soft robot controller at approximately \SI{100}{Hz} passes pressure references to a faster inner PID-like controller regulating the piston at approximately \SI{1}{kHz}~\cite{marchese2014design}.
However, this control scheme is only effective when the delay between the time when a pressure setpoint is set and finally reached is relatively small, which is only the case when either i) the electric drive of the piston is very powerful, fast,, and precise, and/or ii) the configuration/pressure setpoints vary relatively slowly.
Consequently, either very performance, and with that, costly piston actuators are required, or the speed of the dynamic behavior of the soft robot is inherently limited.
We aim to resolve these issues in Chapter~\circled{\ref{chp:backstepping}} by modeling the potential energy stored in the fluidic as a function of the soft robot configuration and the piston positions. This allows us to formulate the coupled dynamics between the soft robotic and the piston system in Euler-Lagrangian form. Finally, we employ a backstepping approach~\cite{kokotovic1992joy, lozano1992adaptive, khalil2002nonlinear} to a nonlinear model-based feedback controller for the coupled system that exploits both the soft robot and the piston dynamics.

\textcolor{orange}{How does this inform the following contributions?}

% \begin{contribution}
%     Techniques for Learning Soft Robot Models that Enable Stable Control in Closed-Form
% \end{contribution}

\begin{contribution}\label{contrib:learned_models}
    Integrating Physical Structure and Stability Guarantees into Learned Models
\end{contribution}

\begin{contribution}\label{contrib:model_based_control_with_learned_models}
    Exploiting Learned Models for Closed-form Model-based Control
\end{contribution}

\begin{contribution}\label{contrib:motion_behaviors}
    Beyond Low-level Control: Generating Compliant Motion Behaviors for Soft Robots
\end{contribution}

We contribute towards \gls{RQ}~\ref{rq:compliant_motion_behaviors} by proposing two approaches that generate compliant motion behavior for soft robots: First, we present Chapter~\circled{\ref{chp:braincontrol}} a \gls{BMI} approach for guiding a low-level impedance control with motor imagery based on measurements by a wearable \gls{EEG} device. Second, we show in Chapter~\circled{\ref{chp:osmp}} how a neural motion policy parametrized by a learned dynamical system with stability guarantees can be used for learning complex motion behaviors from demonstration can be used as a reference provider for a low-level soft robot controller. 
\gls{RQ}~\ref{rq:compliant_motion_behaviors} ensures that not the safety enabled by the soft robot's body and compliant low-level controller is not jeopardized by the high-level motion behavior.
In the following two paragraphs, we will introduce both lines of research in more detail.

\glspl{BMI} promise barrier-free and physical-interaction-free operation of machines, and specifically robots, by analyzing the neural activity of the user and are particularly an interesting choice for allowing robots to assist impaired or elderly people with \gls{ADL}.
However, currently, the classification of motor imagery from few-channel, wearable EEG devices exhibits relatively low accuracy for more than two classes~\cite{arpaia2022non, lee2024noir}. This can cause significant safety concerns when operating high-inertia, fast-moving, rigid robots using motor imagery. Therefore, soft robots, with their passive compliance, seem like a promising avenue as they would allow errors in the \gls{BMI} to occur without jeopardizing safety.
Despite this promise, guiding soft robotic manipulators with \glsxtrfull{BMI} has not yet been explored in literature.
In Chapter~\ref{chp:braincontrol}, we develop a \gls{BCI} protocol that allows users, for the first time, to operate soft robotic manipulators by imagining motor movements.
As an \gls{EEG} device, we use a wearable cap with three channels, which promises in the future to take the operation with brain signals out of stationary lab environments.
As achieving (relatively) high classification accuracies of the motor imagery using \gls{LDA} is currently only feasible on binary classification accuracies, an emphasis of the research was to identify a protocol that allows binary classifications to precisely and robustly control the movement of the soft robot end-effector in a plane.
We achieve this by running two classifiers in parallel, one of which switches the coordinate axis of motion based on the classification of yaw clinching and another that controls the direction of motion (i.e., positive or negative sign) along the active coordinate axis by classifying motor imagery. 
We experimentally verify the proposed \gls{BMI} protocol with a planar \gls{HSA} robot by relaying the task-space references generated by the \gls{BMI} system as setpoints/attractors to the compliant impedance controller developed as part of Contribution~\ref{contrib:actuation_models}.
We quantitatively evaluate the brain signal-guided \emph{control} by visually projecting task-space goals stemming from the sequence of step functions onto a screen behind the \gls{HSA} robot.
The operator then aims to guide the soft robot's end-effector toward the goal as fast as possible with motor imagery.
We benchmark the \gls{BMI} interface against i) a very established \gls{HCI} - a keyboard, and ii) the low-level impedance controller directly having access to the goals, which we consider to be privileged information in this case.
Finally, we also tackle the problem setting of assisting humans with a simple \glsxtrfull{ADL} by guiding the end-effector of a \gls{HSA} robot with brain signals to release hairspray from a bottle, which showcases the compliance and intelligence of the integrated system consisting of body, low-level motor control, and motion guided by the \gls{BMI} system.

\glsxtrfull{DMP} parameterize motion policies with dynamical systems~\cite{ijspeert2013dynamical, saveriano2023dynamic} and allow for efficient learning of complex motions from demonstration (e.g., kinesthetic teaching, biomimetics, teleoperation, etc.).
Particularly interesting is the case where the dynamic system does not exhibit an explicit dependence on time, as this allows for natural and compliant behavior even under perturbation~\cite{ijspeert2013dynamical}.
However, the use of \glspl{DMP} within the realm of soft robotic manipulators has not yet been investigated.
In Chapter~\ref{chp:osmp}, we propose an approach that can learn periodic motions from demonstration and track these demonstrations in a provably stable and compliant fashion without a time dependence.
We accomplish this by building on the trailblazing literature on \glsxtrfull{SMP}~\cite{ijspeert2013dynamical, rana2020euclideanizing, perez2023stable} and propose a new approach that combines a bijective encoder with latent dynamics governed by a supercritical Hopf bifurcation. The \emph{simple} formulation of the latent dynamics allows us to prove their stability easily, and the expressiveness and diffeomorphism enabled by the Euclideanizing flows~\cite{dinh2016density, rana2020euclideanizing} allows us to learn complex motions while giving us the ability transfer these stability guarantees back into the space where the demonstration was provided.
In practice, we map the current position of the robot in oracle space into latent space where we evaluate the \nth{1} order dynamics of the Hopf bifurcation, providing us with a latent velocity.
Subsequently, we evaluate the (analytical) inverse Jacobian of the encoder to map the latent velocity into a desired velocity in oracle space, which would serve as a reference for the low-level motor controller of the system.
We extensively validate this approach experimentally on a helicoid soft robot~\cite{guan2023trimmed}, a turtle robot swimming in a pool, a UR5 manipulator cleaning a whiteboard, and a Kuka cobot in human-contact-rich scenarios.
The presented approach serves as an example of how compliant and natural motion policies for soft robots can be effectively learned from demonstrations of complex behavior.
