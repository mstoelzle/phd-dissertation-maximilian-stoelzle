\chapter{Learning Stable Periodic Robot Motions from Demonstration}
\label{chp:osmp}

\begin{foreword}
    % So far, this thesis has focused mostly on the application of (learned) models within shape sensing and control. Yet, when working towards fully autonomous robots, one of the most challenging research topics is high-level decision making as the controllers that we have considered in this thesis all need either a setpoint or a trajectory to track. In Chapter~\ref{chp:braincontrol}, we introduced an approach to how users could directly control the robot with their thoughts by moving setpoints in space. However, while such low-level \gls{HRI} allows the human to control the robot's actions with vast detail, this requires the full attention of the user and is exhausting for the user, reducing some of the potential efficiency improvements that we envision robots to allow for. A promising alternative could be that the user communicates only high-level tasks to the robot, and the robot plans its motion by itself. Apart from \gls{RL} or optimization-based motion planning strategies such as \gls{MPC}, one of the most promising avenues here is \glsxtrfull{LFD}. Specifically, for 20 years, there has already been literature on learning motion policies with dynamical systems~\citep{ijspeert2013dynamical}, which the community refers to as \glsxtrfull{DMP}. In recent years, the advent of deep learning and normalizing flows~\citep{kobyzev2020normalizing} introduced the new concept of \glsxtrfull{SMP}, where a diffeomorphic mapping into latent space parametrized by a neural network is combined with a latent dynamical system~\citep{rana2020euclideanizing, perez2023stable, zhi2024teaching}. This allows the learning of more complex behaviors while preserving interpretability and stability guarantees. In this chapter, we extend the framework of \gls{SMP} to learning periodic motions while guaranteeing the orbital stability of the system.  We achieve this by combining a bijective encoder based on Euclideanizing flows with latent dynamics based on the supercritical Hopf bifurcation. This concept shares as similar spirit as in Chapter~\ref{chp:con}, although we now apply it to motion policies instead of learned dynamical models.
    % improved version by ChatGPT
    This thesis has so far concentrated primarily on the use of learned models in shape sensing and control. However, a critical challenge in achieving fully autonomous robots lies in high-level decision-making. The controllers discussed in this work require either a setpoint or a trajectory to follow. In Chapter~\ref{chp:braincontrol}, we explored a method enabling users to guide the soft robot directly through their thoughts by manipulating setpoints in space, which a compliant impedance controller subsequently tracks. While this low-level \gls{HRI} provides precise control over the robot’s actions, it demands the user’s full attention and can become exhausting, thereby limiting the efficiency gains we expect to gain by introducing intelligent, autonomous robots.
    %
    An alternative approach involves the user specifying only high-level tasks, allowing the robot to plan its motions independently. Among potential methods, including \gls{RL} and optimization-based strategies like \gls{MPC}, \gls{LFD} stands out as particularly promising as it allows the learning of complex motions from humans or even from other biological creatures. As a special case of \gls{LFD}, research on learning motion policies using dynamical systems has been well-established~\citep {ijspeert2013dynamical}. Being referred to as \glsxtrfull{DMP} or \glsxtrfull{SMP}, this strategy exhibits interpretability, compliant behavior, and convergence guarantees. Recently, advances in deep learning and normalizing flows~\citep{kobyzev2020normalizing} have given rise to frameworks that increase the expressiveness of the motion policy by leveraging diffeomorphic mappings into latent spaces, parametrized by neural networks, combined with latent dynamical systems~\citep{rana2020euclideanizing, perez2023stable, zhi2024teaching}. These methods enable the learning of more complex behaviors while maintaining interpretability, stability, and convergence guarantees.
    %
    In this chapter, we extend this approach to learn periodic motions with guaranteed orbital stability. This is achieved by integrating a bijective encoder based on Euclideanizing flows with latent dynamics modeled as supercritical Hopf bifurcations. The approach aligns in terms of vision with the work in Chapter~\ref{chp:con}, but here, it is applied to motion policy rather than dynamical model learning.
\end{foreword}

\pagebreak

\begin{abstract}
    % As we strive for humans and robots to collaborate closely or to have robots assist us in tasks of daily living, we need to make sure that the robots exhibit compliant, natural, and predictable behavior. 
    % Motion primitives represent velocity (or acceleration) fields that allow us to encode motions without any explicit time dependence and exhibit natural and compliant behaviors even under significant perturbations.
    % In recent years, there has been a strong push to leverage linear latent dynamics with a learned bijective encoder for learning stable, point-to-point motion primitives from demonstrations. However, existing approaches are not able to encode periodic motions.
    % In this work, we present how supercritical Hopf bifurcations in latent space allow for learning periodic motions from demonstration with stability guarantees. We introduce additional techniques such as phase synchronization, latent velocity shaping, and encoder conditioning that allow us to tackle complex, periodic robotic tasks such as turtle swimming or surface cleaning.
    % This will allow collaborative robots to perform periodic motions in an accurate, compliant, stable, and natural fashion and, with that, bring us one step closer to safe and intuitive human-robot collaboration.
    As we aim to foster closer collaboration between humans and robots—or to have robots assist us in everyday tasks—it is essential that these machines exhibit behavior that is robust, compliant, and natural. 
    Learning from demonstrations has proven to be a powerful approach for acquiring complex motion behaviors in a sample-efficient manner compared to methods like reinforcement learning.
    However, many current techniques—such as state-of-the-art diffusion policies—still require a large number of demonstrations to cover most state-action pairs, as these models lack inherent convergence guarantees.
    In contrast, dynamic motion primitives, which parameterize motion policies using dynamical systems, provide such convergence guarantees—often referred to as stable motion primitives—while maintaining natural and compliant behavior even under significant disturbances.
    Recent efforts have focused on leveraging linear latent dynamics paired with a learned, bijective encoder to derive stable, point-to-point motion primitives from demonstrations. However, these methods have fallen short when it comes to encoding periodic motions. In this work, we demonstrate that employing supercritical Hopf bifurcations in latent space can effectively learn periodic motions from demonstrations while ensuring stability. We further introduce techniques such as phase synchronization, online shaping of the convergence behavior, and encoder conditioning, which empower us to address complex periodic robotic tasks like turtle swimming and surface cleaning. These advancements pave the way for collaborative robots to perform periodic motions accurately, compliantly, stably, and naturally—bringing us one step closer to safe and intuitive human-robot interaction.
\end{abstract}

\blfootnote{This chapter is partly based on \faFileTextO ~\emph{\textbf{M. Stölzle}, T.K. Rusch*, Z.J. Patterson*, R. Pérez Dattari, F. Stella, J. Hughes, C. Della Santina, and D. Rus (2025). Learning Stable Periodic Robotic Motions from Demonstration. % In Science Robotics, 
\textbf{\emph{In Preparation}}}.
}

%% Start the actual chapter on a new page.
\newpage

\input{osmp/sections/S01_introduction}
\input{osmp/sections/S02_methodology}
\input{osmp/sections/S03_experiments}
\input{osmp/sections/S04_conclusion}