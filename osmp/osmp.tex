\chapter{Learning Stable Periodic Robotic Motions from Demonstration}
\label{chp:osmp}

\begin{foreword}
    % So far, this thesis has focused mostly on the application of (learned) models within shape sensing and control. Yet, when working towards fully autonomous robots, one of the most challenging research topics is high-level decision making as the controllers that we have considered in this thesis all need either a setpoint or a trajectory to track. In Chapter~\ref{chp:braincontrol}, we introduced an approach to how users could directly control the robot with their thoughts by moving setpoints in space. However, while such low-level \gls{HRI} allows the human to control the robot's actions with vast detail, this requires the full attention of the user and is exhausting for the user, reducing some of the potential efficiency improvements that we envision robots to allow for. A promising alternative could be that the user communicates only high-level tasks to the robot, and the robot plans its motion by itself. Apart from \gls{RL} or optimization-based motion planning strategies such as \gls{MPC}, one of the most promising avenues here is \glsxtrfull{LFD}. Specifically, for 20 years, there has already been literature on learning motion policies with dynamical systems~\cite{ijspeert2013dynamical}, which the community refers to as \glsxtrfull{DMP}. In recent years, the advent of deep learning and normalizing flows~\cite{kobyzev2020normalizing} introduced the new concept of \glsxtrfull{SMP}, where a diffeomorphic mapping into latent space parametrized by a neural network is combined with a latent dynamical system~\cite{rana2020euclideanizing, perez2023stable, zhi2024teaching}. This allows the learning of more complex behaviors while preserving interpretability and stability guarantees. In this chapter, we extend the framework of \gls{SMP} to learning periodic motions while guaranteeing the orbital stability of the system.  We achieve this by combining a bijective encoder based on Euclideanizing flows with latent dynamics based on the supercritical Hopf bifurcation. This concept shares as similar spirit as in Chapter~\ref{chp:con}, although we now apply it to motion policies instead of learned dynamical models.
    % improved version by ChatGPT
    This thesis has so far concentrated primarily on the use of learned models in shape sensing and control. However, a critical challenge in achieving fully autonomous robots lies in high-level decision-making. The controllers discussed in this work require either a setpoint or a trajectory to follow. In Chapter~\circled{\ref{chp:braincontrol}}, we explored a method enabling users to control the robot directly through thought by manipulating setpoints in space. While this low-level \gls{HRI} provides precise control over the robot’s actions, it demands the user’s full attention and can become exhausting, thereby limiting the efficiency gains we expect to gain by introducing intelligent, autonomous robots.
    %
    An alternative approach involves the user specifying only high-level tasks, allowing the robot to plan its motions independently. Among potential methods, including reinforcement learning (RL) and optimization-based strategies like \gls{MPC}, \gls{LFD} stands out as particularly promising as it allows the learning of complex motions from humans or even from other biological crates. As a special case of \gls{LFD}, research on learning motion policies using dynamical systems has been well-established~\cite{ijspeert2013dynamical}. Being referred to as \glsxtrfull{DMP}, this strategy exhibits compliant behavior and shapeable stability characteristics. Recently, advances in deep learning and normalizing flows~\cite{kobyzev2020normalizing} have given rise to \glsxtrfull{SMP}. This framework leverages diffeomorphic mappings into latent spaces, parametrized by neural networks, combined with latent dynamical systems~\cite{rana2020euclideanizing, perez2023stable, zhi2024teaching}. \gls{SMP} enables the learning of more complex behaviors while maintaining interpretability and stability guarantees.
    %
    In this chapter, we extend the \gls{SMP} framework to learn periodic motions with guaranteed orbital stability. This is achieved by integrating a bijective encoder based on Euclideanizing flows with latent dynamics modeled on the supercritical Hopf bifurcation. The approach aligns conceptually with the work in Chapter~\circled{\ref{chp:con}}, but here, it is applied to motion policy learning rather than learned dynamical models.
\end{foreword}

\blfootnote{This chapter is partly based on \faFileTextO ~\emph{\textbf{M. Stölzle}, T.K. Rusch*, Z.J. Patterson*, R. Pérez Dattari, F. Stella, J. Hughes, C. Della Santina, and D. Rus (2025). Learning Stable Periodic Robotic Motions from Demonstration. In Science Robotics, \textbf{\emph{In Preparation}}}.}

\pagebreak

\begin{abstract}
    As we strive for humans and robots to collaborate closely or to have robots assist us in tasks of daily living, we need to make sure that the robots exhibit compliant, natural, and predictable behavior. 
    Motion primitives represent velocity (or acceleration) fields that allow us to encode motions without any explicit time dependence and exhibit natural and compliant behaviors even under significant perturbations.
    In recent years, there has been a strong push to leverage linear latent dynamics with a learned bijective encoder for learning stable, point-to-point motion primitives from demonstrations. However, existing approaches are not able to encode periodic motions.
    In this work, we present how supercritical Hopf bifurcations in latent space allow for learning periodic motions from demonstration with stability guarantees. We introduce additional techniques such as phase synchronization, latent velocity shaping, and encoder conditioning that allow us to tackle complex, periodic robotic tasks such as turtle swimming or surface cleaning.
    This will allow collaborative robots to perform periodic motions in an accurate, compliant, stable, and natural fashion and, with that, bring us one step closer to safe and intuitive human-robot collaboration.
\end{abstract}

